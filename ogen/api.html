<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Public APIs</title>
        <style>
            body {
                font-family: Arial, sans-serif;
            }

            #api-list {
                display: grid;
                grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
                grid-gap: 1rem;
                padding: 0;
                list-style: none;
            }

            .api-item {
                background-color: #ffffff;
                padding: 1rem;
                border-radius: 5px;
            }

            .api-title {
                font-size: 1.2rem;
                margin-bottom: 0.5rem;
            }

            .api-description {
                margin-bottom: 0.5rem;
            }

            #progress-bar-container {
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                height: 3px;
                background-color: transparent;
                z-index: 100;
            }

            #progress-bar {
                height: 100%;
                width: 0;
                background-color: red;
            }

            @keyframes progressBar {
                from {
                    width: 0;
                }
                to {
                    width: 100%;
                }
            }

            #category-filter {
                display: grid;
                grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
                grid-gap: 1rem;
                padding: 0;
                list-style: none;
            }

        .skeleton-loader {
            display: inline-block;
            width: 100%;
            height: 1rem;
            background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
        }

        @keyframes loading {
            0% {
                background-position: 200% 0;
            }
            100% {
                background-position: -200% 0;
            }
        }
        </style>
    </head>
    <body>




        <div id="progress-bar-container">
            <div id="progress-bar"></div>
        </div>

        <input type="text" id="search-input" placeholder="Search APIs" />

        <div>
             <h3>Filter by Category</h3>
            <div id="category-filter"></div>
            <button id="clear-filters">Clear Filters</button>
        </div>




        <h1>Public APIs</h1>
        <ul id="api-list"></ul>
        <script>
            const vintageColors = {
                'Animals': '#F7DCB4',
                'Anime': '#EED8BE',
                'Anti-Malware': '#E4D4C8',
                'Art & Design': '#DBC0D2',
                'Books': '#D1ACDC',
                'Business': '#C799E6',
                'Calendar': '#BE85F0',
                'Cloud Storage & File Sharing': '#B471FA',
                'Continuous Integration': '#AB5DFF',
                'Cryptocurrency': '#A149FF',
                'Currency Exchange': '#9834FF',
                'Data Validation': '#8E20FF',
                'Development': '#8411FF',
                'Dictionaries': '#7B02FF',
                'Documents & Productivity': '#7104FF',
                'Environment': '#6805FF',
                'Events': '#5E07FF',
                'Finance': '#5508FF',
                'Food & Drink': '#4C0AFF',
                'Games & Comics': '#430BFF',
                'Geocoding': '#3A0DFF',
                'Government': '#310EFF',
                'Health': '#280FFF',
                'Jobs': '#1F11FF'
            };


            const pastelColors = {
                'Animals': '#8B7765',
                'Anime': '#FFB347',
                'Anti-Malware': '#FF6961',
                'Art & Design': '#DFFF00',
                'Books': '#77DD77',
                'Business': '#AEC6CF',
                'Calendar': '#F49AC2',
                'Cloud Storage & File Sharing': '#779ECB',
                'Continuous Integration': '#C23B22',
                'Cryptocurrency': '#836953',
                'Currency Exchange': '#FFD1DC',
                'Data Validation': '#B39EB5',
                'Development': '#FF6961',
                'Dictionaries': '#CB99C9',
                'Documents & Productivity': '#DEA5A4',
                'Environment': '#966FD6',
                'Events': '#FDFD96',
                'Finance': '#FFB347',
                'Food & Drink': '#DFFF00',
                'Games & Comics': '#B19CD9',
                'Geocoding': '#C23B22',
                'Government': '#779ECB',
                'Health': '#AEC6CF',
                'Jobs': '#F49AC2'
            };

            function getCategoryColor2(category) {
                return pastelColors[category] || '#F0F0F0';
            }


            function getCategoryColor(category) {
                return vintageColors[category] || '#B8B8B8';
            }

            async function fetchPublicAPIs() {
                const response = await fetch('https://api.publicapis.org/entries');
                const data = await response.json();
                return data.entries;
            }


            function getCategoryColorPastelColors(category) {
                return pastelColors[category] || '#CCCCCC';
            }

            function getCategoryBackgroundColor(category) {
                const color = getCategoryColorPastelColors(category);
                const rgbaColor = color.replace('#', '');
                const r = parseInt(rgbaColor.substr(0, 2), 16);
                const g = parseInt(rgbaColor.substr(2, 2), 16);
                const b = parseInt(rgbaColor.substr(4, 2), 16);
                return `rgba(${r}, ${g}, ${b}, 0.2)`;
            }


            let publicAPIs = [];
            let filteredAPIs = [];
            let categories = [];


        function displayCategoryFilterSkeleton() {
            const categoryFilter = document.getElementById('category-filter');
            const apiList = document.getElementById('api-list');
            categoryFilter.innerHTML = `
                <div class="skeleton-loader"></div>
            `;
            apiList.innerHTML = `
                <div class="skeleton-loader"></div>
            `;
        }


        // function buildCategoryFilter() {
        //     const categoryFilter = document.getElementById('category-filter');
        //     categoryFilter.innerHTML = `
        //         ${categories.map(category => `
        //             <div>
        //                 <input type="checkbox" id="${category}-checkbox" value="${category}" />
        //                 <label for="${category}-checkbox">${category}</label>
        //             </div>
        //         `).join('')}
        //     `;
        //     categoryFilter.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {
        //         checkbox.addEventListener('change', () => {
        //             filterByCategories();
        //         });
        //     });
        // }


        function buildCategoryFilter() {
            let categoryFilter = document.getElementById('category-filter');
            let categoryCheckboxes = categories.map(category => {
                return `
                    <div>
                        <input type="checkbox" id="${category}" value="${category}">
                        <label for="${category}">${category}</label>
                    </div>
                `;
            }).join('');

            categoryFilter.innerHTML = `
                ${categoryCheckboxes}
            `;

            categories.forEach(category => {
                const checkbox = document.getElementById(category);
                checkbox.addEventListener('change', () => {
                    searchInput.value = '';
                    filterByCategories();
                });
            });
        }





function filterByCategories() {
    const selectedCategories = Array.from(document.querySelectorAll('input[type="checkbox"]:checked')).map(checkbox => checkbox.value);
    if (selectedCategories.length === 0) {
        filteredAPIs = publicAPIs;
    } else {
        filteredAPIs = publicAPIs.filter(api => selectedCategories.includes(api.Category));
    }
    displayPublicAPIs();
}

        function clearCategoryFilters() {
            document.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {
                checkbox.checked = false;
            });
            filteredAPIs = publicAPIs;
            displayPublicAPIs();
        }

        function displayPublicAPIs() {
            const apiList = document.getElementById('api-list');
            apiList.innerHTML = filteredAPIs.map(api => `
                <li class="api-item" style="background-color: ${getCategoryBackgroundColor(api.Category)}; border: 3px solid ${getCategoryColor(api.Category)}">
                    <h2 class="api-title">${api.API}</h2>
                    <p class="api-description">${api.Description}</p>
                    <p><strong>Category:</strong> ${api.Category}</p>
                    <p><strong>Link:</strong> <a href="${api.Link}" target="_blank">Link here</a></p>
                </li>
            `).join('');
        }

        function filterAPIs(searchQuery) {
            searchQuery = searchQuery.toLowerCase();
            filteredAPIs = publicAPIs.filter(api => {
                return api.API.toLowerCase().includes(searchQuery) ||
                    api.Description.toLowerCase().includes(searchQuery) ||
                    api.Category.toLowerCase().includes(searchQuery);
            });
            displayPublicAPIs();
        }

        function showProgressBar() {
                const progressBar = document.getElementById('progress-bar');
                progressBar.style.animation = 'progressBar 2s linear infinite';
            }

            function hideProgressBar() {
                const progressBar = document.getElementById('progress-bar');
                progressBar.style.animation = 'none';
                progressBar.style.width = '100%';

                setTimeout(() => {
                    const progressBarContainer = document.getElementById('progress-bar-container');
                    progressBarContainer.style.display = 'none';
                }, 1200);
            }

        async function loadPublicAPIs() {
            displayCategoryFilterSkeleton();
            try {
                    showProgressBar();
                    const apis = await fetchPublicAPIs();
                    displayPublicAPIs(apis);
                    hideProgressBar();
                } catch (error) {
                    console.error(error);
                    hideProgressBar();
                }
            publicAPIs = await fetchPublicAPIs();
            filteredAPIs = publicAPIs;
            categories = [...new Set(publicAPIs.map(api => api.Category))].sort();
            displayPublicAPIs();
            hideProgressBar();
            buildCategoryFilter();

        }

        const searchInput = document.getElementById('search-input');
        searchInput.addEventListener('input', event => {
            const searchQuery = event.target.value;
            clearCategoryFilters();
            filterAPIs(searchQuery);
        });

        const clearFiltersButton = document.getElementById('clear-filters');
        clearFiltersButton.addEventListener('click', () => {
            clearCategoryFilters();
        });


        loadPublicAPIs();
        </script>
    </body>
</html>
